import{m as C,_ as W,g as A,h,o as g,c as V,a as b,b as l,w as t,i as _,j as v,F as z,k as $,E as d,d as u,l as q}from"./index-692e4f4b.js";import{c as S,E as N,a as j,b as H,d as M,e as O,f as R,g as G}from"./el-table-column-cc17af67.js";import{E as J}from"./el-date-picker-d3949ecf.js";import{b as K,E as Q,a as X,c as Y}from"./index-1e243f61.js";const Z=e=>C.request({url:"/mall/ums-permission/page",method:"post",data:e}),x=e=>C.request({url:"/mall/ums-permission/del/"+e.id,params:e}),ee=e=>C.request({url:"/mall/ums-permission/add",method:"post",data:e}),le=e=>C.request({url:"/mall/ums-permission/edit",method:"post",data:e}),ae=e=>C.request({url:"/mall/ums-permission/one/"+e.id,params:e});const te=A({setup(){const{permission:e}=$("permissions");return{permission:e}},data(){return{searchText:"",coupons:[],adCates:[],page:{total:0,current:1,size:10},dialogFormVisible:!1,dialogFormVisibleById:!1,adCate:{createTime:"",icon:"",id:0,name:"",pid:0,sort:0,status:0,type:0,uri:"",value:""},formLabelWidth:100}},mounted(){this.getAdCatesPage(1)},methods:{toEdit(e){console.log(e),this.dialogFormVisible=!0,this.adCate=S(e)},getAdCatesPage(e){Z({current:e,size:5}).then(s=>{console.log(s);const m=s.data.page;this.adCates=m.records,this.page=m}).catch(s=>{console.log(s)})},currentchange(e){this.getAdCatesPage(e),this.page.current=e},refresh(){this.getAdCatesPage(this.page.current),d({message:"刷新成功",type:"success"})},clearSearchInput(){this.searchText="",d({message:"搜索内容已清空",type:"success"})},sortHandler(e,a){if(!e.sort)return 1;if(!a.sort)return-1;e.sort-a.sort<0},del(e){N.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a={id:e};d({message:"删除成功",type:"success"}),x(a).then(s=>{if(s.success)this.getAdCatesPage(this.page.current);else return console.log(s.msg),!1}).catch(s=>{console.log(s)})}).catch(()=>{d({message:"取消删除",type:"warning"})})},toAdd(){this.adCate={createTime:"",icon:"",id:0,name:"",pid:0,sort:0,status:0,type:0,uri:"",value:""},this.dialogFormVisible=!0},selectById(){this.dialogFormVisibleById=!0},getById(e){this.coupons=[],ae({id:e}).then(s=>{this.dialogFormVisibleById=!1,this.coupons.push(s.data.help);const m=this.coupons;this.adCates=m,d({message:"查询成功",type:"success"})}).catch(s=>{d({message:"查询的ID不存在",type:"warning"}),console.log(s)})},save(){const e=this.adCate;e.id==0?ee(e).then(a=>{if(a.success)this.dialogFormVisible=!1,this.getAdCatesPage(this.page.current),d({message:"添加成功",type:"success"});else return d({message:"添加失败",type:"error"}),!1}).catch(a=>{d({message:"网络错误联系管理员",type:"error"})}):le(e).then(a=>{if(a.success)this.dialogFormVisible=!1,this.getAdCatesPage(this.page.current),d({message:"更新成功",type:"success"});else return d({message:"更新失败",type:"error"}),!1}).catch(a=>{d({message:"网络错误联系管理员",type:"error"})})}}}),oe={class:"adCates"},se={class:"adcate-tools"},de=["src"],ne={key:1},ie={class:"dialog-footer"},re={class:"search-input-wrapper"},ue={class:"dialog-footer"};function pe(e,a,s,m,me,ce){const E=h("Refresh"),c=q,i=K,I=h("Plus"),n=O,B=h("Edit"),F=h("Delete"),T=j,D=H,p=Q,r=X,f=R,y=G,P=J,w=Y,U=h("Check"),k=M;return g(),V(z,null,[b("div",oe,[b("div",se,[l(i,{type:"warning",color:"#006699",onClick:e.refresh},{default:t(()=>[l(c,null,{default:t(()=>[l(E)]),_:1}),u("刷新")]),_:1},8,["onClick"]),e.permission()?(g(),_(i,{key:0,type:"warning",color:"#006699",onClick:e.toAdd},{default:t(()=>[l(c,null,{default:t(()=>[l(I)]),_:1}),u("添加")]),_:1},8,["onClick"])):v("",!0),l(i,{type:"warning",onClick:e.selectById,icon:"Search"},{default:t(()=>[u("按ID查询")]),_:1},8,["onClick"])]),l(T,{data:e.adCates,style:{width:"100%"}},{default:t(()=>[l(n,{fixed:"",prop:"id",label:"id",width:"50"}),l(n,{prop:"name",label:"名称"}),l(n,{prop:"pid",label:"父级权限ID"}),l(n,{prop:"icon",label:"icon"},{default:t(({row:o})=>[o.icon?(g(),V("img",{key:0,src:o.icon,style:{width:"50px",height:"50px"}},null,8,de)):(g(),V("span",ne,"无头像"))]),_:1}),l(n,{prop:"sort",label:"排序",sortable:"","default-sort":{order:"ascending"},"sort-method":e.sortHandler},null,8,["sort-method"]),l(n,{prop:"type",label:"权限类型"}),l(n,{prop:"value",label:"权限值"}),l(n,{prop:"uri",label:"前端资源路径"}),l(n,{prop:"createTime",label:"创建时间"}),l(n,{prop:"status",label:"帐号启用状态"}),e.permission()?(g(),_(n,{key:0,fixed:"right",label:"操作",width:"120"},{default:t(o=>[l(i,{link:"",type:"primary",size:"small",onClick:L=>e.toEdit(o.row)},{default:t(()=>[l(c,null,{default:t(()=>[l(B)]),_:1}),u("更新")]),_:2},1032,["onClick"]),l(i,{link:"",type:"danger",size:"small",onClick:L=>e.del(o.row.id)},{default:t(()=>[l(c,null,{default:t(()=>[l(F)]),_:1}),u("删除")]),_:2},1032,["onClick"])]),_:1})):v("",!0)]),_:1},8,["data"]),l(D,{background:"",layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),l(k,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":a[10]||(a[10]=o=>e.dialogFormVisible=o),title:"权限编辑"},{footer:t(()=>[b("span",ie,[l(i,{onClick:a[9]||(a[9]=o=>e.dialogFormVisible=!1)},{default:t(()=>[u("取消")]),_:1}),l(i,{type:"primary",onClick:e.save},{default:t(()=>[l(c,null,{default:t(()=>[l(U)]),_:1}),u("保存")]),_:1},8,["onClick"])])]),default:t(()=>[l(w,{model:e.adCate},{default:t(()=>[l(r,{label:"名称","label-width":e.formLabelWidth},{default:t(()=>[l(p,{modelValue:e.adCate.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.adCate.name=o),autocomplete:"off",placeholder:"名称"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"父级权限ID","label-width":e.formLabelWidth},{default:t(()=>[l(p,{modelValue:e.adCate.pid,"onUpdate:modelValue":a[1]||(a[1]=o=>e.adCate.pid=o),autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"头像","label-width":e.formLabelWidth},{default:t(()=>[l(p,{modelValue:e.adCate.icon,"onUpdate:modelValue":a[2]||(a[2]=o=>e.adCate.icon=o),autocomplete:"off",placeholder:"请输入头像网页http链接"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"排序","label-width":e.formLabelWidth},{default:t(()=>[l(p,{modelValue:e.adCate.sort,"onUpdate:modelValue":a[3]||(a[3]=o=>e.adCate.sort=o),autocomplete:"off",placeholder:"请输入排序"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"权限类型","label-width":e.formLabelWidth},{default:t(()=>[l(y,{modelValue:e.adCate.type,"onUpdate:modelValue":a[4]||(a[4]=o=>e.adCate.type=o),placeholder:"please select your zone"},{default:t(()=>[l(f,{label:"目录(0)",value:"0"}),l(f,{label:"菜单(1)",value:"1"}),l(f,{label:"按钮(2)",value:"2"})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"权限值","label-width":e.formLabelWidth},{default:t(()=>[l(p,{modelValue:e.adCate.value,"onUpdate:modelValue":a[5]||(a[5]=o=>e.adCate.value=o),autocomplete:"off",placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"前端资源路径","label-width":e.formLabelWidth},{default:t(()=>[l(p,{modelValue:e.adCate.uri,"onUpdate:modelValue":a[6]||(a[6]=o=>e.adCate.uri=o),autocomplete:"off",placeholder:"请输入前端资源路径"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"创建时间","label-width":e.formLabelWidth},{default:t(()=>[l(P,{modelValue:e.adCate.createTime,"onUpdate:modelValue":a[7]||(a[7]=o=>e.adCate.createTime=o),type:"date",autocomplete:"off",placeholder:"选择日期"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(r,{label:"状态","label-width":e.formLabelWidth},{default:t(()=>[l(y,{modelValue:e.adCate.status,"onUpdate:modelValue":a[8]||(a[8]=o=>e.adCate.status=o),placeholder:"please select your zone"},{default:t(()=>[l(f,{label:"启用(1)",value:"1"}),l(f,{label:"禁用(0)",value:"0"})]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(k,{modelValue:e.dialogFormVisibleById,"onUpdate:modelValue":a[14]||(a[14]=o=>e.dialogFormVisibleById=o),title:"查询"},{footer:t(()=>[b("span",ue,[l(i,{onClick:a[13]||(a[13]=o=>e.dialogFormVisibleById=!1)},{default:t(()=>[u("取消")]),_:1})])]),default:t(()=>[l(w,{model:e.adCate},{default:t(()=>[l(r,{label:"请输入ID","label-width":e.formLabelWidth},{default:t(()=>[b("div",re,[l(p,{modelValue:e.searchText,"onUpdate:modelValue":a[11]||(a[11]=o=>e.searchText=o),placeholder:"按ID查询,请输入ID",autocomplete:"off",class:"search-input"},null,8,["modelValue"]),l(i,{type:"primary",icon:"Search",onClick:a[12]||(a[12]=o=>e.getById(e.searchText))}),l(i,{type:"danger",icon:"Delete",onClick:e.clearSearchInput,class:"search-clear-btn"},null,8,["onClick"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const Ce=W(te,[["render",pe],["__scopeId","data-v-1888adb9"]]);export{Ce as default};
