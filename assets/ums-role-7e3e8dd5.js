import{m as g,_ as P,g as A,h as b,o as C,c as $,a as m,b as l,w as a,i as w,j as k,F as S,k as U,E as n,d as r,l as z,p as L,f as W}from"./index-692e4f4b.js";import{c as q,E as N,a as R,b as j,d as H,e as M,f as O,g as G}from"./el-table-column-cc17af67.js";import{b as J,E as K,a as Q,c as X}from"./index-1e243f61.js";const Y=e=>g.request({url:"/mall/ums-role/page",method:"post",data:e}),Z=e=>g.request({url:"/mall/ums-role/del/"+e.id,params:e}),x=e=>g.request({url:"/mall/ums-role/add",method:"post",data:e}),ee=e=>g.request({url:"/mall/ums-role/edit",method:"post",data:e}),le=e=>g.request({url:"mall/ums-role/one/"+e.id,params:e});const te=A({setup(){const{permission:e}=U("permissions");return{permission:e}},data(){return{searchText:"",coupons:[],adCates:[],page:{total:0,current:1,size:10},dialogFormVisible:!1,dialogFormVisibleById:!1,adCate:{adminCount:0,createTime:"",description:"",id:0,name:"",sort:0,status:0},formLabelWidth:100}},mounted(){this.getAdCatesPage(1)},methods:{toEdit(e){console.log(e),this.dialogFormVisible=!0,this.adCate=q(e)},getAdCatesPage(e){Y({current:e,size:6}).then(s=>{console.log(s);const p=s.data.page;this.adCates=p.records,this.page=p}).catch(s=>{console.log(s)})},currentchange(e){this.getAdCatesPage(e),this.page.current=e},refresh(){this.getAdCatesPage(this.page.current),n({message:"刷新成功",type:"success"})},clearSearchInput(){this.searchText="",n({message:"搜索框内容已清空",type:"success"})},sortHandler(e,t){return e.sort?t.sort?e.sort-t.sort:-1:1},del(e){N.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t={id:e};n({message:"删除成功",type:"success"}),Z(t).then(s=>{if(s.success)this.getAdCatesPage(this.page.current);else return console.log(s.msg),!1}).catch(s=>{console.log(s)})}).catch(()=>{n({message:"取消删除",type:"warning"})})},toAdd(){this.adCate={adminCount:0,createTime:"",description:"选择权限",id:0,name:"",sort:0,status:"选择状态"},this.dialogFormVisible=!0},selectById(){this.dialogFormVisibleById=!0},getById(e){this.coupons=[],le({id:e}).then(s=>{this.dialogFormVisibleById=!1,this.coupons.push(s.data.help);const p=this.coupons;this.adCates=p,n({message:"查询成功",type:"success"})}).catch(s=>{n({message:"查询的ID不存在",type:"warning"}),console.log(s)})},save(){const e=this.adCate;e.id==0?x(e).then(t=>{if(t.success)this.dialogFormVisible=!1,this.getAdCatesPage(this.page.current),n({message:"添加成功",type:"success"});else return n({message:"添加失败",type:"error"}),!1}).catch(t=>{n({message:"网络错误联系管理员",type:"error"})}):ee(e).then(t=>{if(t.success)this.dialogFormVisible=!1,this.getAdCatesPage(this.page.current),n({message:"更新成功",type:"success"});else return n({message:"刷新失败",type:"success"}),!1}).catch(t=>{n({message:"网络错误联系管理员",type:"error"})})}}}),ae=e=>(L("data-v-e7d433d7"),e=e(),W(),e),oe={class:"adCates"},se={class:"adcate-tools"},ne=ae(()=>m("span",{style:{color:"red"}},"*",-1)),de={class:"dialog-footer"},re={class:"search-input-wrapper"},ie={class:"dialog-footer"};function ue(e,t,s,p,me,pe){const I=b("Refresh"),f=z,d=J,E=b("Plus"),i=M,v=b("Edit"),B=b("Delete"),F=R,T=j,h=K,u=Q,c=O,V=G,y=X,_=H;return C(),$(S,null,[m("div",oe,[m("div",se,[l(d,{type:"warning",color:"#006699",onClick:e.refresh},{default:a(()=>[l(f,null,{default:a(()=>[l(I)]),_:1}),r("刷新")]),_:1},8,["onClick"]),e.permission()?(C(),w(d,{key:0,type:"warning",color:"#006699",onClick:e.toAdd},{default:a(()=>[l(f,null,{default:a(()=>[l(E)]),_:1}),r("添加")]),_:1},8,["onClick"])):k("",!0),l(d,{type:"warning",onClick:e.selectById,icon:"Search"},{default:a(()=>[r("按ID查询")]),_:1},8,["onClick"])]),l(F,{data:e.adCates,style:{width:"100%"}},{default:a(()=>[l(i,{fixed:"",prop:"id",label:"id",width:"50"}),l(i,{prop:"name",label:"名称"}),l(i,{prop:"adminCount",label:"后台用户数量"}),l(i,{prop:"description",label:"描述"}),l(i,{prop:"sort",label:"排序",sortable:"","default-sort":{order:"ascending"},"sort-method":e.sortHandler},null,8,["sort-method"]),l(i,{prop:"createTime",label:"创建时间"}),l(i,{prop:"status",label:"帐号启用状态"}),e.permission()?(C(),w(i,{key:0,fixed:"right",label:"操作",width:"120"},{default:a(o=>[l(d,{link:"",type:"primary",size:"small",onClick:D=>e.toEdit(o.row)},{default:a(()=>[l(f,null,{default:a(()=>[l(v)]),_:1}),r("更新")]),_:2},1032,["onClick"]),l(d,{link:"",type:"danger",size:"small",onClick:D=>e.del(o.row.id)},{default:a(()=>[l(f,null,{default:a(()=>[l(B)]),_:1}),r("删除")]),_:2},1032,["onClick"])]),_:1})):k("",!0)]),_:1},8,["data"]),l(T,{background:"",layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),l(_,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[6]||(t[6]=o=>e.dialogFormVisible=o),title:"角色编辑"},{footer:a(()=>[m("span",de,[l(d,{onClick:t[5]||(t[5]=o=>e.dialogFormVisible=!1)},{default:a(()=>[r("取消")]),_:1}),l(d,{type:"primary",onClick:e.save},{default:a(()=>[r("保存")]),_:1},8,["onClick"])])]),default:a(()=>[l(y,{model:e.adCate},{default:a(()=>[l(u,{label:"名称","label-width":e.formLabelWidth},{default:a(()=>[l(h,{modelValue:e.adCate.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.adCate.name=o),autocomplete:"off",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"后台用户数量","label-width":e.formLabelWidth},{default:a(()=>[l(h,{modelValue:e.adCate.adminCount,"onUpdate:modelValue":t[1]||(t[1]=o=>e.adCate.adminCount=o),autocomplete:"off",placeholder:"请输入后台用户数量"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"描述","label-width":e.formLabelWidth},{default:a(()=>[l(V,{modelValue:e.adCate.description,"onUpdate:modelValue":t[2]||(t[2]=o=>e.adCate.description=o)},{default:a(()=>[l(c,{label:"无权限",value:"无权限"}),l(c,{label:"只能查看及操作商品",value:"只能查看及操作商品"}),l(c,{label:"拥有所有查看和操作功能",value:"拥有所有查看和操作功能"})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"排序","label-width":e.formLabelWidth},{default:a(()=>[l(h,{modelValue:e.adCate.sort,"onUpdate:modelValue":t[3]||(t[3]=o=>e.adCate.sort=o),autocomplete:"off",placeholder:"请输入排序"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"状态","label-width":e.formLabelWidth},{label:a(()=>[ne,r(" 状态 ")]),default:a(()=>[l(V,{modelValue:e.adCate.status,"onUpdate:modelValue":t[4]||(t[4]=o=>e.adCate.status=o)},{default:a(()=>[l(c,{label:"启用(1)",value:"1"}),l(c,{label:"禁用(0)",value:"0"})]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(_,{modelValue:e.dialogFormVisibleById,"onUpdate:modelValue":t[10]||(t[10]=o=>e.dialogFormVisibleById=o),title:"查询"},{footer:a(()=>[m("span",ie,[l(d,{onClick:t[9]||(t[9]=o=>e.dialogFormVisibleById=!1)},{default:a(()=>[r("取消")]),_:1})])]),default:a(()=>[l(y,{model:e.adCate},{default:a(()=>[l(u,{label:"请输入ID","label-width":e.formLabelWidth},{default:a(()=>[m("div",re,[l(h,{modelValue:e.searchText,"onUpdate:modelValue":t[7]||(t[7]=o=>e.searchText=o),placeholder:"按ID查询,请输入ID",autocomplete:"off",class:"search-input"},null,8,["modelValue"]),l(d,{type:"primary",icon:"Search",onClick:t[8]||(t[8]=o=>e.getById(e.searchText))}),l(d,{type:"danger",icon:"Delete",onClick:e.clearSearchInput,class:"search-clear-btn"},null,8,["onClick"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const he=P(te,[["render",ue],["__scopeId","data-v-e7d433d7"]]);export{he as default};
