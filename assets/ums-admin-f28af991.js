import{_ as U,g as P,h as c,o as b,c as w,a as p,b as l,w as o,i as C,j as _,F as $,k as S,E as n,d as r,t as z,l as L}from"./index-692e4f4b.js";import{c as N,E as W,a as R,b as q,d as j,e as O,f as G,g as H}from"./el-table-column-cc17af67.js";import{c as J,d as K,e as Q,f as X,g as Y,h as Z,i as x}from"./ums-admin-c5a4d8f3.js";import{b as ee,E as le,a as ae,c as oe}from"./index-1e243f61.js";const se=P({setup(){const{permission:e}=S("permissions");return{permission:e}},data(){return{searchText:"",adminRole:{1:"商品管理员",2:"订单管理员",3:"超级管理员"},coupons:[],adMins:[],page:{total:0,current:1,size:10},dialogFormVisible:!1,dialogFormVisibleById:!1,roleDialogVisible:!1,selectedAdmin:{id:0,role:"1"},adMin:{createTime:"",email:"",icon:"",id:0,loginTime:"",nickName:"",note:"",password:"",status:0,username:"",role:""},formLabelWidth:100,rules:{username:[{required:!0,message:"账号不能为空",trigger:"blur"},{min:8,message:"账号长度不能少于8个字符",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:8,message:"密码长度不能少于8个字符",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}]}}},mounted(){this.getAdMinsPage(1)},methods:{toEdit(e){console.log(e),this.dialogFormVisible=!0,this.adMin=N(e)},torole(e){this.selectedAdmin.id=e.id,this.selectedAdmin.role=e.role||"1",this.roleDialogVisible=!0},async saveRole(){const e=this.adMins.find(t=>t.id===this.selectedAdmin.id);e.role?await K({id:e.id,roleId:this.selectedAdmin.role}):await J({id:e.id,roleId:this.selectedAdmin.role});const a=localStorage.getItem("adminId");e.id==a&&(localStorage.setItem("roleId",this.selectedAdmin.role),this.refresh()),this.roleDialogVisible=!1,n.success("管理员角色设置成功")},getAdMinsPage(e){Q({current:e,size:3}).then(t=>{console.log(t);const f=t.data.page;this.adMins=f.records,this.page=f}).catch(t=>{console.log(t)})},currentchange(e){this.getAdMinsPage(e),this.page.current=e},refresh(){this.getAdMinsPage(this.page.current),n({message:"刷新成功",type:"success"})},clearSearchInput(){this.searchText="",n({message:"搜索框内容已清空",type:"success"})},del(e){W.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a={id:e};n({message:"删除成功",type:"success"}),X(a).then(t=>{if(t.success)this.getAdMinsPage(this.page.current);else return console.log(t.msg),!1}).catch(t=>{console.log(t)})}).catch(()=>{n({message:"取消删除",type:"warning"})})},toAdd(){this.adMin={createTime:"",email:"",icon:"",id:0,loginTime:"",nickName:"",note:"",password:"",status:0,username:"",role:""},this.dialogFormVisible=!0},selectById(){this.dialogFormVisibleById=!0},getById(e){this.coupons=[],Y({id:e}).then(t=>{this.dialogFormVisibleById=!1,this.coupons.push(t.data.help);const f=this.coupons;this.adMins=f,n({message:"查询成功",type:"success"})}).catch(t=>{n({message:"查询的ID不存在",type:"warning"}),console.log(t)})},save(){const e=this.adMin;e.id==0?Z(e).then(a=>{if(a.success)this.dialogFormVisible=!1,this.getAdMinsPage(this.page.current),n({message:"添加成功",type:"success"});else return n({message:"添加失败",type:"error"}),!1}).catch(a=>{n({message:"请查看输入内容或格式是否有误！",type:"error"})}):x(e).then(a=>{if(a.success)this.dialogFormVisible=!1,this.getAdMinsPage(this.page.current),n({message:"更新成功",type:"success"});else return n({message:"更新失败",type:"error"}),!1}).catch(a=>{n({message:"请查看输入内容或格式是否有误！",type:"error"})})}}}),te={class:"adMins"},ie={class:"admin-tools"},ne=["src"],de={key:1},re={class:"dialog-footer"},me={class:"dialog-footer"},ue={class:"search-input-wrapper"},pe={class:"dialog-footer"};function ge(e,a,t,f,ce,fe){const I=c("Refresh"),g=L,i=ee,v=c("Plus"),d=O,A=c("Setting"),E=c("Edit"),B=c("Delete"),D=R,F=q,u=le,m=ae,h=G,k=H,V=oe,T=c("Check"),y=j;return b(),w($,null,[p("div",te,[p("div",ie,[l(i,{type:"warning",color:"#006699",onClick:e.refresh},{default:o(()=>[l(g,null,{default:o(()=>[l(I)]),_:1}),r("刷新")]),_:1},8,["onClick"]),e.permission()?(b(),C(i,{key:0,type:"warning",color:"#006699",onClick:e.toAdd},{default:o(()=>[l(g,null,{default:o(()=>[l(v)]),_:1}),r("添加")]),_:1},8,["onClick"])):_("",!0),l(i,{type:"warning",onClick:e.selectById,icon:"Search"},{default:o(()=>[r("按ID查询")]),_:1},8,["onClick"])]),l(D,{data:e.adMins,style:{width:"100%"}},{default:o(()=>[l(d,{fixed:"",prop:"id",label:"id",width:"50"}),l(d,{prop:"username",label:"用户名"}),l(d,{prop:"icon",label:"头像"},{default:o(({row:s})=>[s.icon?(b(),w("img",{key:0,src:s.icon,style:{width:"50px",height:"50px"}},null,8,ne)):(b(),w("span",de,"无头像"))]),_:1}),l(d,{prop:"email",label:"邮箱"}),l(d,{prop:"nickName",label:"昵称"}),l(d,{prop:"note",label:"备注信息"}),l(d,{prop:"createTime",label:"创建时间"}),l(d,{prop:"loginTime",label:"最后登录时间"}),l(d,{prop:"status",label:"帐号启用状态"}),l(d,{prop:"role",label:"角色"},{default:o(({row:s})=>[p("span",null,z(e.adminRole[s.role]||"暂无角色"),1)]),_:1}),e.permission()?(b(),C(d,{key:0,fixed:"right",label:"操作",width:"120"},{default:o(s=>[l(i,{link:"",type:"success",size:"small",onClick:M=>e.torole(s.row)},{default:o(()=>[l(g,null,{default:o(()=>[l(A)]),_:1}),r("设置管理员")]),_:2},1032,["onClick"]),l(i,{link:"",type:"primary",size:"small",onClick:M=>e.toEdit(s.row)},{default:o(()=>[l(g,null,{default:o(()=>[l(E)]),_:1}),r("更新")]),_:2},1032,["onClick"]),l(i,{link:"",type:"danger",size:"small",onClick:M=>e.del(s.row.id)},{default:o(()=>[l(g,null,{default:o(()=>[l(B)]),_:1}),r("删除")]),_:2},1032,["onClick"])]),_:1})):_("",!0)]),_:1},8,["data"]),l(F,{background:"",layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),l(y,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":a[8]||(a[8]=s=>e.dialogFormVisible=s),title:"admin编辑"},{footer:o(()=>[p("span",re,[l(i,{onClick:a[7]||(a[7]=s=>e.dialogFormVisible=!1)},{default:o(()=>[r("取消")]),_:1}),l(i,{type:"primary",onClick:e.save},{default:o(()=>[l(g,null,{default:o(()=>[l(T)]),_:1}),r("保存")]),_:1},8,["onClick"])])]),default:o(()=>[l(V,{model:e.adMin},{default:o(()=>[l(m,{label:"用户名",prop:"username",rules:e.rules.username,"label-width":e.formLabelWidth},{default:o(()=>[l(u,{modelValue:e.adMin.username,"onUpdate:modelValue":a[0]||(a[0]=s=>e.adMin.username=s),autocomplete:"off",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1},8,["rules","label-width"]),l(m,{label:"密码",prop:"password",rules:e.rules.password,"label-width":e.formLabelWidth},{default:o(()=>[l(u,{modelValue:e.adMin.password,"onUpdate:modelValue":a[1]||(a[1]=s=>e.adMin.password=s),type:"text",autocomplete:"off",placeholder:"请输入密码","show-password":!0},null,8,["modelValue"])]),_:1},8,["rules","label-width"]),l(m,{label:"头像","label-width":e.formLabelWidth},{default:o(()=>[l(u,{modelValue:e.adMin.icon,"onUpdate:modelValue":a[2]||(a[2]=s=>e.adMin.icon=s),autocomplete:"off",placeholder:"请输入头像网页http链接"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"邮箱",prop:"email",rules:e.rules.email,"label-width":e.formLabelWidth},{default:o(()=>[l(u,{modelValue:e.adMin.email,"onUpdate:modelValue":a[3]||(a[3]=s=>e.adMin.email=s),autocomplete:"off",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1},8,["rules","label-width"]),l(m,{label:"昵称","label-width":e.formLabelWidth},{default:o(()=>[l(u,{modelValue:e.adMin.nickName,"onUpdate:modelValue":a[4]||(a[4]=s=>e.adMin.nickName=s),autocomplete:"off",placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"备注信息","label-width":e.formLabelWidth},{default:o(()=>[l(u,{modelValue:e.adMin.note,"onUpdate:modelValue":a[5]||(a[5]=s=>e.adMin.note=s),autocomplete:"off",placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"状态","label-width":e.formLabelWidth},{default:o(()=>[l(k,{modelValue:e.adMin.status,"onUpdate:modelValue":a[6]||(a[6]=s=>e.adMin.status=s),placeholder:"please select your zone"},{default:o(()=>[l(h,{label:"启用(1)",value:"1"}),l(h,{label:"禁用(0)",value:"0"})]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(y,{modelValue:e.roleDialogVisible,"onUpdate:modelValue":a[11]||(a[11]=s=>e.roleDialogVisible=s),title:"设置管理员"},{footer:o(()=>[p("span",me,[l(i,{onClick:a[10]||(a[10]=s=>e.roleDialogVisible=!1)},{default:o(()=>[r("取消")]),_:1}),l(i,{type:"primary",onClick:e.saveRole},{default:o(()=>[r("保存")]),_:1},8,["onClick"])])]),default:o(()=>[l(V,{model:e.selectedAdmin,"label-width":"80px"},{default:o(()=>[l(m,{label:"角色"},{default:o(()=>[l(k,{modelValue:e.selectedAdmin.role,"onUpdate:modelValue":a[9]||(a[9]=s=>e.selectedAdmin.role=s),placeholder:"请选择角色"},{default:o(()=>[l(h,{label:"商品管理员",value:"1"}),l(h,{label:"订单管理员",value:"2"}),l(h,{label:"超级管理员",value:"26"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(y,{modelValue:e.dialogFormVisibleById,"onUpdate:modelValue":a[15]||(a[15]=s=>e.dialogFormVisibleById=s),title:"查询"},{footer:o(()=>[p("span",pe,[l(i,{onClick:a[14]||(a[14]=s=>e.dialogFormVisibleById=!1)},{default:o(()=>[r("取消")]),_:1})])]),default:o(()=>[l(V,{model:e.adMin},{default:o(()=>[l(m,{label:"请输入ID","label-width":e.formLabelWidth},{default:o(()=>[p("div",ue,[l(u,{modelValue:e.searchText,"onUpdate:modelValue":a[12]||(a[12]=s=>e.searchText=s),placeholder:"按ID查询,请输入ID",autocomplete:"off",class:"search-input"},null,8,["modelValue"]),l(i,{type:"primary",icon:"Search",onClick:a[13]||(a[13]=s=>e.getById(e.searchText))}),l(i,{type:"danger",icon:"Delete",onClick:e.clearSearchInput,class:"search-clear-btn"},null,8,["onClick"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const we=U(se,[["render",ge],["__scopeId","data-v-33f00093"]]);export{we as default};
